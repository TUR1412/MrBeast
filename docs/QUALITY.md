# 质量与审查（原子级）

本文件记录本项目的“原子级”交付标准，方便你二次迭代时保持一致的体验与稳健性。

---

## 1) 交互体验

### 1.1 反馈必须“讲人话”

- 禁止在主界面裸露 JSON、错误堆栈、原始日志
- 表单/交互反馈统一走 Toast（`#toast-root`）

### 1.2 按钮必须有物理反馈

- `:hover` 有上浮/高光
- `:active` 有缩放（例如 `scale(0.97)`）

---

## 2) 可访问性（A11y）

### 2.1 键盘可用

- 提供 Skip Link：`.skip-link`
- 所有可交互元素有清晰的 `:focus-visible` 描边

### 2.2 移动端菜单无“幽灵焦点”

- 在移动端（`max-width: 768px`）菜单关闭时：
  - 导航列表启用 `aria-hidden="true"`
  - 导航列表启用 `inert`（若浏览器支持）

这样读屏与键盘焦点不会“穿过遮罩点到背后的链接”。

---

## 3) 动效与降级

### 3.1 Reduced Motion

- 侦测 `prefers-reduced-motion: reduce`
- 在 Reduced Motion 场景：
  - 粒子动效不启动
  - Confetti 不触发
  - 轮播不自动播放
  - 滚动入场不做位移动画

### 3.2 默认可见（避免 JS 救场）

滚动入场动画采用“默认可见 + JS 仅位移”的策略：

- 没有 JS：内容照常可见
- 有 JS：添加轻微位移，进入视口后归位

---

## 4) 性能与稳定性

### 4.1 粒子连线避免 O(n²)

连线逻辑采用“网格近邻搜索”，避免在高分辨率大屏下每帧做全量两两距离计算。

### 4.2 视口外跳过渲染

在支持的浏览器上启用 `content-visibility: auto`，让视口外大区块跳过布局与绘制，降低电量消耗。

---

## 5) 缓存穿透（Cache Busting）

每次修改核心逻辑/样式后，必须更新 `index.html` 中静态资源版本号：

```html
<link rel="stylesheet" href="assets/styles.css?v=20251217-03">
<script src="assets/app.js?v=20251217-03" defer></script>
```

目的：避免浏览器缓存导致“改了但不生效”的幽灵问题。

